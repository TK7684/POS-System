<!doctype html>
<html lang="th">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>POS & Inventory System</title>

        <!-- Supabase SDK -->
        <script type="module">
            // Use ES module import for Supabase
            import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm';
            
            // Store createClient globally so supabase-config.js can use it
            window.supabaseCreateClient = createClient;
            window.supabaseLoaded = true;
            
            // Dispatch event when loaded
            window.dispatchEvent(new CustomEvent('supabase-loaded'));
        </script>

        <!-- Tailwind CSS -->
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
          // Suppress Tailwind CDN production warning
          if (window.tailwind) {
            window.tailwind.config = window.tailwind.config || {};
            window.tailwind.config.silent = true;
          }
        </script>

        <!-- PWA Manifest -->
        <link rel="manifest" href="manifest.json" />
        <meta name="theme-color" content="#0f766e" />

        <style>
            :root {
                --spacing-xs: 0.25rem;
                --spacing-sm: 0.5rem;
                --spacing-md: 1rem;
                --spacing-lg: 1.5rem;
                --spacing-xl: 2rem;
                --spacing-2xl: 3rem;
                --fs-xs: 0.75rem;
                --fs-sm: 0.875rem;
                --fs-md: 1rem;
                --fs-lg: 1.125rem;
                --fs-xl: 1.25rem;
                --fs-2xl: 1.5rem;
                --fs-3xl: 1.875rem;
                --fs-4xl: 2.25rem;
                --muted: #6b7280;
                --brand: #0891b2;
                --brand-ink: #ffffff;
                --card: #ffffff;
                --line: #e5e7eb;
                --bg: #f8fafc;
            }

            * {
                box-sizing: border-box;
            }

            body {
                font-family:
                    system-ui,
                    -apple-system,
                    sans-serif;
                color: #111;
                background: #f6f7fb;
                padding-bottom: env(safe-area-inset-bottom);
                margin: 0;
                padding: 0;
            }

            .container {
                width: 100%;
                max-width: min(960px, 100vw - 2rem);
                margin: 0 auto;
                padding: 0 var(--spacing-md);
            }
            .card {
                background: var(--card);
                border: 1px solid var(--line);
                border-radius: 14px;
                padding: 16px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
                margin-bottom: var(--spacing-md);
            }
            .btn {
                display: inline-flex;
                align-items: center;
                justify-content: center;
                padding: var(--spacing-md) var(--spacing-xl);
                border: 2px solid transparent;
                border-radius: 0.75rem;
                font-size: var(--fs-md);
                font-weight: 600;
                cursor: pointer;
                min-height: 44px;
                text-decoration: none;
            }
            .btn.brand {
                background: var(--brand);
                color: var(--brand-ink);
            }
            .btn.ghost {
                background: #fff;
                border-color: var(--line);
                color: #111;
            }
            .input {
                width: 100%;
                padding: var(--spacing-md);
                border: 2px solid #e5e7eb;
                border-radius: 0.75rem;
                font-size: var(--fs-md);
                background: #fff;
            }
            .input:focus {
                outline: none;
                border-color: var(--brand);
                box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
            }
            .supabase-status {
                position: fixed;
                top: 0;
                right: 0;
                padding: 0;
                font-size: 12px;
                font-weight: 600;
                z-index: 1000;
            }
            .supabase-status.connected {
                color: #10b981;
                background: transparent;
            }
            .supabase-status.disconnected {
                color: #ef4444;
                background: transparent;
            }
            .supabase-status.demo {
                background: #f59e0b;
                color: #fff;
            }
            .spinner {
                border: 3px solid #f3f4f6;
                border-top: 3px solid #0891b2;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                animation: spin 1s linear infinite;
            }
            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }
            .hidden {
                display: none !important;
            }
            @media (max-width: 768px) {
                .container {
                    padding: 0 var(--spacing-sm);
                }
                /* Hide top bar on mobile - bottom nav is sufficient */
                #app-topbar {
                    display: none !important;
                }
                /* Adjust padding for mobile */
                #pos-app {
                    padding-top: 16px !important;
                    padding-bottom: 80px !important;
                }
                /* Hide Quick Actions on mobile - already in bottom nav */
                .quick-actions-mobile-hide {
                    display: none !important;
                }
                /* Make buttons smaller on mobile */
                .btn {
                    padding: var(--spacing-sm) var(--spacing-md);
                    font-size: var(--fs-sm);
                    min-height: 40px;
                }
                /* Ensure bottom nav buttons fit */
                #app-bottomnav {
                    padding: 0;
                    padding-bottom: env(safe-area-inset-bottom, 0);
                }
                #app-bottomnav .grid {
                    gap: 0;
                    grid-template-columns: repeat(5, 1fr);
                    width: 100%;
                }
                #app-bottomnav button {
                    padding: 4px 1px;
                    font-size: 8px;
                    min-height: 52px;
                    max-height: 52px;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    overflow: hidden;
                    width: 100%;
                    border: none;
                    background: transparent;
                }
                #app-bottomnav button span:first-child {
                    font-size: 16px;
                    line-height: 1;
                    margin-bottom: 1px;
                }
                #app-bottomnav button span:last-child {
                    font-size: 8px;
                    line-height: 1;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    max-width: 100%;
                    padding: 0 1px;
                }
                /* Make cards more compact on mobile */
                .card {
                    padding: 12px;
                    margin-bottom: var(--spacing-sm);
                }
                /* Make user info buttons wrap and smaller on mobile */
                #pos-app .card:last-child .flex {
                    flex-wrap: wrap;
                }
                #pos-app .card:last-child button {
                    font-size: 0.75rem;
                    padding: 0.375rem 0.5rem;
                    min-height: 36px;
                }
            }
        </style>
    </head>
    <body>
        <!-- Sticky Top App Bar (Desktop only) -->
        <div id="app-topbar" class="fixed top-0 inset-x-0 z-50 bg-white/90 backdrop-blur border-b border-gray-200 hidden md:block">
            <div class="container" style="padding-top: 8px; padding-bottom: 8px;">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <div class="w-8 h-8 rounded-lg bg-teal-600 text-white flex items-center justify-center font-bold">POS</div>
                        <div class="font-semibold">POS-20251110-1514</div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="goToHomepage()" class="btn ghost text-sm">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                        <button onclick="openSaleModal()" class="btn brand text-sm">‡∏Ç‡∏≤‡∏¢</button>
                        <button onclick="openPurchaseModal()" class="btn ghost text-sm">‡∏ã‡∏∑‡πâ‡∏≠</button>
                        <button onclick="openExpensesHistory()" class="btn ghost text-sm">‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</button>
                        <button onclick="openCalendarModal()" class="btn ghost text-sm">‡∏™‡∏£‡∏∏‡∏õ</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Supabase Status Indicator -->
        <div id="supabase-status" class="supabase-status disconnected">
            Disconnected
        </div>

        <!-- Authentication Screen -->
        <div id="auth-screen" class="container" style="display: block;">
            <div class="card" style="max-width: 400px; margin: 50px auto">
                <h2 class="text-2xl font-bold mb-6">POS System Login</h2>

                <!-- Google Sign-In Button -->
                <button
                    type="button"
                    id="google-signin-btn"
                    class="btn ghost w-full mb-4"
                    style="
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 8px;
                    "
                >
                    <svg
                        width="18"
                        height="18"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 48 48"
                    >
                        <path
                            fill="#EA4335"
                            d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"
                        />
                        <path
                            fill="#4285F4"
                            d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"
                        />
                        <path
                            fill="#FBBC05"
                            d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"
                        />
                        <path
                            fill="#34A853"
                            d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"
                        />
                        <path fill="none" d="M0 0h48v48H0z" />
                    </svg>
                    <span>Sign in with Google</span>
                </button>

                <div class="relative mb-4">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-gray-300"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-white text-gray-500"
                            >Or continue with email</span
                        >
                    </div>
                </div>

                <form id="login-form">
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2"
                            >Email</label
                        >
                        <input
                            type="email"
                            id="email"
                            class="input"
                            required
                            placeholder="your@email.com"
                        />
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2"
                            >Password</label
                        >
                        <input
                            type="password"
                            id="password"
                            class="input"
                            required
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                        />
                    </div>
                    <button type="submit" class="btn brand w-full">
                        <span id="login-btn-text">Sign In</span>
                        <div
                            id="login-spinner"
                            class="spinner hidden"
                            style="width: 20px; height: 20px; margin-left: 10px"
                        ></div>
                    </button>
                </form>
                <div
                    id="login-error"
                    class="mt-4 p-3 bg-red-100 text-red-700 rounded hidden"
                ></div>
            </div>
        </div>

        <!-- Main POS Application -->
        <div id="pos-app" class="container" style="padding-top: 64px; padding-bottom: 88px; display: none;">
            <header>
                <h1 class="text-3xl font-bold mb-2">POS & Inventory</h1>
                <p class="text-gray-600">
                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡∏∑‡πâ‡∏≠/‡∏Ç‡∏≤‡∏¢ ¬∑ ‡∏™‡∏ï‡πä‡∏≠‡∏Å ¬∑ ‡πÅ‡∏ö‡∏ö Real-time
                </p>
            </header>

            <!-- Dashboard Stats -->
            <div id="homepage-dashboard" class="grid grid-cols-2 md:grid-cols-4 gap-4 my-6">
                <div class="card bg-gradient-to-br from-blue-50 to-blue-100">
                    <div class="text-sm text-gray-600 mb-1">üí∞ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                    <div class="text-2xl font-bold text-blue-600" id="dashboard-today-sales">‡∏ø0</div>
                    <div class="text-xs text-gray-500 mt-1" id="dashboard-today-count">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
                </div>
                <div class="card bg-gradient-to-br from-green-50 to-green-100">
                    <div class="text-sm text-gray-600 mb-1">üì¶ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                    <div class="text-2xl font-bold text-green-600" id="dashboard-total-ingredients">0</div>
                    <div class="text-xs text-gray-500 mt-1" id="dashboard-low-stock">0 ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î</div>
                </div>
                <div class="card bg-gradient-to-br from-purple-50 to-purple-100">
                    <div class="text-sm text-gray-600 mb-1">üçΩÔ∏è ‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                    <div class="text-2xl font-bold text-purple-600" id="dashboard-total-menus">0</div>
                    <div class="text-xs text-gray-500 mt-1" id="dashboard-available-menus">0 ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢</div>
                </div>
                <div class="card bg-gradient-to-br from-orange-50 to-orange-100">
                    <div class="text-sm text-gray-600 mb-1">üí∏ ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div>
                    <div class="text-2xl font-bold text-orange-600" id="dashboard-month-expenses">‡∏ø0</div>
                    <div class="text-xs text-gray-500 mt-1" id="dashboard-expense-count">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 my-6">
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openSaleModal()">
                    <div class="text-3xl mb-2">üõí</div>
                    <h3 class="font-semibold mb-2">‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                    <p class="text-xs text-gray-600">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</p>
                </div>
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openPurchaseModal()">
                    <div class="text-3xl mb-2">üì¶</div>
                    <h3 class="font-semibold mb-2">‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</h3>
                    <p class="text-xs text-gray-600">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠</p>
                </div>
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openExpensesHistory()">
                    <div class="text-3xl mb-2">üí∞</div>
                    <h3 class="font-semibold mb-2">‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h3>
                    <p class="text-xs text-gray-600">‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</p>
                </div>
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openMenusPage()">
                    <div class="text-3xl mb-2">üçΩÔ∏è</div>
                    <h3 class="font-semibold mb-2">‡πÄ‡∏°‡∏ô‡∏π</h3>
                    <p class="text-xs text-gray-600">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π</p>
                </div>
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openStockPage()">
                    <div class="text-3xl mb-2">üì¶</div>
                    <h3 class="font-semibold mb-2">‡∏™‡∏ï‡πä‡∏≠‡∏Å</h3>
                    <p class="text-xs text-gray-600">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Å</p>
                </div>
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openCostStockPage()">
                    <div class="text-3xl mb-2">üìä</div>
                    <h3 class="font-semibold mb-2">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô & ‡∏™‡∏ï‡πä‡∏≠‡∏Å</h3>
                    <p class="text-xs text-gray-600">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</p>
                </div>
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openStockReconciliationPage()">
                    <div class="text-3xl mb-2">üìã</div>
                    <h3 class="font-semibold mb-2">‡∏ô‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å</h3>
                    <p class="text-xs text-gray-600">‡∏ô‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å & ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</p>
                </div>
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openPackagingPage()">
                    <div class="text-3xl mb-2">üì¶</div>
                    <h3 class="font-semibold mb-2">‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</h3>
                    <p class="text-xs text-gray-600">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</p>
                </div>
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openCOGSDashboard()">
                    <div class="text-3xl mb-2">üí∞</div>
                    <h3 class="font-semibold mb-2">COGS & ‡∏Å‡∏≥‡πÑ‡∏£</h3>
                    <p class="text-xs text-gray-600">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≤‡∏¢</p>
                </div>
                <div class="card hover:shadow-lg transition-shadow cursor-pointer" onclick="openReportsDashboard()">
                    <div class="text-3xl mb-2">üìà</div>
                    <h3 class="font-semibold mb-2">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h3>
                    <p class="text-xs text-gray-600">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô & ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</p>
                </div>
            </div>

            <!-- Real-time Stock Status -->
            <div class="card">
                <h3 class="font-semibold mb-3">üö® ‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î (Real-time)</h3>
                <div id="low-stock-list">
                    <div class="spinner" style="margin: 20px auto"></div>
                </div>
            </div>

            <!-- Recent Transactions -->
            <div class="card">
                <h3 class="font-semibold mb-3">üìù ‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                <div id="recent-transactions">
                    <div class="spinner" style="margin: 20px auto"></div>
                </div>
            </div>

            <!-- Cost & Stock Analysis Page (Hidden by default) -->
            <div id="cost-stock-page" class="hidden" style="display: none;">
                <div class="card">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4">
                        <div class="flex items-center gap-3">
                            <button onclick="goToHomepage()" class="btn brand">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                            <button onclick="closeCostStockPage()" class="btn ghost">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
                            <h3 class="font-semibold text-xl">üìä ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô & ‡∏™‡∏ï‡πä‡∏≠‡∏Å</h3>
                        </div>
                        <button onclick="refreshCostStockData()" class="btn ghost">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                    </div>

                    <!-- Summary Cards -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600 mb-1">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏£‡∏ß‡∏°</div>
                            <div class="text-2xl font-bold text-blue-600" id="cost-total-value">‡∏ø0</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600 mb-1">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                            <div class="text-2xl font-bold text-green-600" id="cost-total-items">0</div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600 mb-1">‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î</div>
                            <div class="text-2xl font-bold text-yellow-600" id="cost-low-stock">0</div>
                        </div>
                        <div class="bg-red-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600 mb-1">‡∏´‡∏°‡∏î‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                            <div class="text-2xl font-bold text-red-600" id="cost-out-of-stock">0</div>
                        </div>
                    </div>

                    <!-- Cost Analysis Table -->
                    <div class="mb-4">
                        <h4 class="font-semibold mb-3">üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b bg-gray-50">
                                        <th class="text-left p-2">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</th>
                                        <th class="text-right p-2">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                                        <th class="text-right p-2">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                        <th class="text-right p-2">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°</th>
                                        <th class="text-right p-2">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</th>
                                        <th class="text-center p-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                    </tr>
                                </thead>
                                <tbody id="cost-stock-table">
                                    <tr>
                                        <td colspan="6" class="text-center p-8">
                                            <div class="spinner" style="margin: 20px auto"></div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stock Management (Hidden by default, shown via menu) -->
            <div id="stock-management-page" class="hidden" style="display: none;">
                <div class="card">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-3">
                        <div class="flex items-center gap-3">
                            <button onclick="goToHomepage()" class="btn brand">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                            <button onclick="closeStockPage()" class="btn ghost">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
                            <h3 class="font-semibold">üì¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Å</h3>
                        </div>
                        <div class="flex gap-2 w-full md:w-auto">
                            <input id="stock-search" type="text" class="input flex-1 md:w-64" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö..." autocomplete="off" />
                            <button id="stock-refresh" class="btn ghost">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                            <button id="stock-add-ingredient" class="btn brand">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</button>
                        </div>
                    </div>
                    <div id="stock-table" class="overflow-x-auto">
                        <div class="spinner" style="margin: 20px auto"></div>
                    </div>
                    <div id="stock-pagination" class="flex items-center justify-between mt-3">
                        <div class="text-sm text-gray-600" id="stock-page-info"></div>
                        <div class="flex gap-2">
                            <button id="stock-prev" class="btn ghost text-sm">‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
                            <button id="stock-next" class="btn ghost text-sm">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User Info -->
            <div class="card mt-6">
                <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-3">
                    <div>
                        <span class="text-sm text-gray-600">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: </span>
                        <span id="user-email" class="font-medium"></span>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <button
                            onclick="openAIChatbot()"
                            class="btn brand text-xs md:text-sm px-2 md:px-4"
                        >
                            ü§ñ AI
                        </button>
                        <button
                            onclick="showBackfillPanel()"
                            class="btn ghost text-xs md:text-sm px-2 md:px-4"
                        >
                            üì• Backfill
                        </button>
                        <button
                            onclick="showDebugPanel()"
                            class="btn ghost text-xs md:text-sm px-2 md:px-4 hidden md:inline-flex"
                        >
                            üîç Debug
                        </button>
                        <button onclick="logout()" class="btn ghost text-xs md:text-sm px-2 md:px-4">
                            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sticky Bottom Navigation (Mobile-first, shown on all screens) -->
        <nav id="app-bottomnav" class="fixed bottom-0 inset-x-0 z-50 bg-white/95 backdrop-blur border-t border-gray-200 md:hidden hidden">
            <div class="grid grid-cols-5 text-xs">
                <button onclick="goToHomepage()" class="py-2 flex flex-col items-center justify-center active:bg-gray-100 transition-colors">
                    <span class="text-lg">üè†</span>
                    <span class="text-[10px] leading-tight">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</span>
                </button>
                <button onclick="openSaleModal()" class="py-2 flex flex-col items-center justify-center active:bg-gray-100 transition-colors">
                    <span class="text-lg">üõí</span>
                    <span class="text-[10px] leading-tight">‡∏Ç‡∏≤‡∏¢</span>
                </button>
                <button onclick="openPurchaseModal()" class="py-2 flex flex-col items-center justify-center active:bg-gray-100 transition-colors">
                    <span class="text-lg">üì¶</span>
                    <span class="text-[10px] leading-tight">‡∏ã‡∏∑‡πâ‡∏≠</span>
                </button>
                <button onclick="openExpensesHistory()" class="py-2 flex flex-col items-center justify-center active:bg-gray-100 transition-colors">
                    <span class="text-lg">üí∞</span>
                    <span class="text-[10px] leading-tight">‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</span>
                </button>
                <button onclick="openAIChatbot()" class="py-2 flex flex-col items-center justify-center active:bg-gray-100 transition-colors">
                    <span class="text-lg">ü§ñ</span>
                    <span class="text-[10px] leading-tight">‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢</span>
                </button>
            </div>
        </nav>

        <!-- Sale Modal -->
        <div
            id="sale-modal"
            class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50"
        >
            <div class="card max-w-md w-full mx-4">
                <h3 class="text-xl font-bold mb-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h3>
                <form id="sale-form">
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2"
                            >‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°</label
                        >
                        <select id="sale-platform" class="input">
                            <option value="‡∏£‡πâ‡∏≤‡∏ô">‡∏£‡πâ‡∏≤‡∏ô</option>
                            <option value="Grab">Grab</option>
                            <option value="FoodPanda">FoodPanda</option>
                            <option value="Line Man">Line Man</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2"
                            >‡πÄ‡∏°‡∏ô‡∏π</label
                        >
                        <select id="sale-menu" class="input">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π...</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2"
                            >‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label
                        >
                        <input
                            type="number"
                            id="sale-qty"
                            class="input"
                            min="1"
                            value="1"
                        />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2"
                            >‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢</label
                        >
                        <input
                            type="number"
                            id="sale-price"
                            class="input"
                            min="0"
                            step="0.01"
                        />
                    </div>
                    <div class="flex gap-2">
                        <button type="submit" class="btn brand flex-1">
                            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢
                        </button>
                        <button
                            type="button"
                            onclick="closeSaleModal()"
                            class="btn ghost flex-1"
                        >
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Purchase Modal -->
        <div
            id="purchase-modal"
            class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50"
        >
            <div class="card max-w-md w-full mx-4">
                <h3 class="text-xl font-bold mb-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠</h3>
                <form id="purchase-form">
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2"
                            >‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</label
                        >
                        <select id="purchase-ingredient" class="input">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö...</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2"
                            >‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠</label
                        >
                        <input
                            type="number"
                            id="purchase-qty"
                            class="input"
                            min="0"
                            step="0.01"
                        />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2"
                            >‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°</label
                        >
                        <input
                            type="number"
                            id="purchase-price"
                            class="input"
                            min="0"
                            step="0.01"
                        />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2"
                            >‡∏´‡∏ô‡πà‡∏ß‡∏¢</label
                        >
                        <input
                            type="text"
                            id="purchase-unit"
                            class="input"
                            placeholder="‡∏Å‡∏Å., ‡∏•‡∏¥‡∏ï‡∏£"
                        />
                    </div>
                    <div class="flex gap-2">
                        <button type="submit" class="btn brand flex-1">
                            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠
                        </button>
                        <button
                            type="button"
                            onclick="closePurchaseModal()"
                            class="btn ghost flex-1"
                        >
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Toast Notification -->
        <div
            id="toast"
            class="fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-full opacity-0 transition-opacity duration-200 pointer-events-none z-50"
        ></div>

        <!-- AI Chatbot Modal -->
        <div
            id="ai-chatbot-modal"
            class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50"
        >
            <div class="card max-w-2xl w-full mx-4 h-[600px] flex flex-col">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h3 class="text-xl font-bold">ü§ñ AI Assistant</h3>
                        <p class="text-sm text-gray-600">‡∏ä‡πà‡∏ß‡∏¢‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ï‡πá‡∏≠‡∏Å</p>
                    </div>
                    <button
                        onclick="closeAIChatbot()"
                        class="btn ghost text-sm"
                    >
                        ‚úï
                    </button>
                </div>
                
                <div
                    id="chat-messages"
                    class="flex-1 overflow-y-auto mb-4 p-4 bg-gray-50 rounded-lg space-y-3"
                >
                    <div class="flex items-start gap-2">
                        <div class="w-8 h-8 rounded-full bg-teal-500 flex items-center justify-center text-white text-sm font-bold">
                            AI
                        </div>
                        <div class="flex-1 bg-white p-3 rounded-lg shadow-sm">
                            <p class="text-sm">
                                ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏∏‡∏ì‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏∞ ü§ñ<br>
                                ‡∏û‡∏¥‡∏°‡∏û‡πå "‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞!
                            </p>
                        </div>
                    </div>
                </div>
                
                <form id="chat-form" class="flex gap-2">
                    <input
                        type="text"
                        id="chat-input"
                        class="input flex-1"
                        placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á... ‡πÄ‡∏ä‡πà‡∏ô '‡∏ã‡∏∑‡πâ‡∏≠ ‡∏Å‡∏∏‡πâ‡∏á‡∏™‡∏î 100 ‡∏ï‡∏±‡∏ß ‡∏£‡∏≤‡∏Ñ‡∏≤ 500 ‡∏ö‡∏≤‡∏ó'"
                        autocomplete="off"
                    />
                    <button type="submit" class="btn brand">
                        ‡∏™‡πà‡∏á
                    </button>
                </form>
            </div>
        </div>

        <!-- Calendar Summary Modal -->
        <div id="calendar-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="card max-w-2xl w-full mx-4">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">üìÜ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö-‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3>
                    <button onclick="closeCalendarModal()" class="btn ghost text-sm">‚úï</button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
                        <input type="month" id="summary-month" class="input" />
                    </div>
                    <div class="md:col-span-2 flex items-end gap-2">
                        <button onclick="refreshMonthlySummary()" class="btn brand">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó</button>
                        <button onclick="downloadMonthlyReport()" class="btn ghost">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
                    </div>
                </div>

                <div id="monthly-summary" class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-4">
                    <div class="p-3 rounded-lg border bg-green-50">
                        <div class="text-sm text-gray-600">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö (‡∏Ç‡∏≤‡∏¢)</div>
                        <div id="sum-revenue" class="text-2xl font-bold text-green-700">‡∏ø0.00</div>
                    </div>
                    <div class="p-3 rounded-lg border bg-red-50">
                        <div class="text-sm text-gray-600">‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</div>
                        <div id="sum-expenses" class="text-2xl font-bold text-red-700">‡∏ø0.00</div>
                    </div>
                    <div class="p-3 rounded-lg border bg-blue-50">
                        <div class="text-sm text-gray-600">‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á</div>
                        <div id="sum-labor" class="text-2xl font-bold text-blue-700">‡∏ø0.00</div>
                    </div>
                    <div class="p-3 rounded-lg border bg-amber-50">
                        <div class="text-sm text-gray-600">‡∏Å‡∏≥‡πÑ‡∏£‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</div>
                        <div id="sum-profit" class="text-2xl font-bold text-amber-700">‡∏ø0.00</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <div class="card" style="margin-bottom:0">
                        <h4 class="font-semibold mb-2">‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</h4>
                        <div id="expenses-breakdown" class="text-sm text-gray-700"></div>
                    </div>
                    <div class="card" style="margin-bottom:0">
                        <h4 class="font-semibold mb-2">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö)</h4>
                        <div id="revenue-by-day" class="text-sm text-gray-700 max-h-64 overflow-auto"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Adjust Stock Modal -->
        <div id="adjust-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="card max-w-md w-full mx-4">
                <h3 class="text-xl font-bold mb-4">‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å</h3>
                <form id="adjust-form">
                    <input type="hidden" id="adjust-ingredient-id" />
                    <div class="mb-3 text-sm text-gray-700" id="adjust-ingredient-name"></div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏ï‡πä‡∏≠‡∏Å (+/-)</label>
                        <input type="number" step="0.01" id="adjust-qty" class="input" required />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</label>
                        <input type="text" id="adjust-reason" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡∏±‡∏ö, ‡πÅ‡∏ï‡∏Å‡∏´‡∏±‡∏Å" />
                    </div>
                    <div class="flex gap-2">
                        <button type="submit" class="btn brand flex-1">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                        <button type="button" onclick="closeAdjustModal()" class="btn ghost flex-1">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Waste Modal -->
        <div id="waste-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="card max-w-md w-full mx-4">
                <h3 class="text-xl font-bold mb-4">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢</h3>
                <form id="waste-form">
                    <input type="hidden" id="waste-ingredient-id" />
                    <div class="mb-3 text-sm text-gray-700" id="waste-ingredient-name"></div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ó‡∏¥‡πâ‡∏á</label>
                        <input type="number" step="0.01" id="waste-qty" class="input" required />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</label>
                        <input type="text" id="waste-reason" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏, ‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢" />
                    </div>
                    <div class="flex gap-2">
                        <button type="submit" class="btn brand flex-1">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                        <button type="button" onclick="closeWasteModal()" class="btn ghost flex-1">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Ingredient Modal -->
        <div id="ingredient-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="card max-w-md w-full mx-4">
                <h3 class="text-xl font-bold mb-4" id="ingredient-modal-title">‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</h3>
                <form id="ingredient-form">
                    <input type="hidden" id="ingredient-id" />
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</label>
                        <input type="text" id="ingredient-name" class="input" required />
                    </div>
                    <div class="mb-4 grid grid-cols-2 gap-2">
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏´‡∏ô‡πà‡∏ß‡∏¢</label>
                            <input type="text" id="ingredient-unit" class="input" placeholder="‡∏ï‡∏±‡∏ß, ‡∏Å‡∏£‡∏±‡∏°, ‡∏Å‡∏Å., ‡∏Ç‡∏ß‡∏î" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</label>
                            <input type="number" step="0.01" id="ingredient-min" class="input" />
                        </div>
                    </div>
                    <div class="mb-4 grid grid-cols-2 gap-2">
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
                            <input type="number" step="0.01" id="ingredient-stock" class="input" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ø)</label>
                            <input type="number" step="0.01" id="ingredient-cost" class="input" />
                        </div>
                    </div>
                    <div class="mb-4 grid grid-cols-2 gap-2">
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢</label>
                            <input type="text" id="ingredient-supplier" class="input" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏Å‡πá‡∏ö</label>
                            <input type="text" id="ingredient-location" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏π‡πâ‡πÄ‡∏¢‡πá‡∏ô, ‡∏Ñ‡∏£‡∏±‡∏ß" />
                        </div>
                    </div>
                    <div class="mb-4 grid grid-cols-2 gap-2">
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏à‡∏∏‡∏î‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà</label>
                            <input type="number" step="0.01" id="ingredient-reorder" class="input" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</label>
                            <input type="number" step="0.01" id="ingredient-max" class="input" />
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                        <textarea id="ingredient-description" class="input" rows="2" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"></textarea>
                    </div>
                    <div class="flex gap-2">
                        <button type="submit" class="btn brand flex-1">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                        <button type="button" onclick="closeIngredientModal()" class="btn ghost flex-1">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Expenses Modal -->
        <div id="expenses-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="card max-w-md w-full mx-4">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">üí∞ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h3>
                    <button onclick="closeExpensesModal()" class="btn ghost text-sm">‚úï</button>
                </div>
                <form id="expenses-form">
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                        <select id="expense-category" class="input" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó...</option>
                            <option value="utility">‚ö° ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü/‡∏ô‡πâ‡∏≥ (Utilities)</option>
                            <option value="rental">üè† ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ (Rental)</option>
                            <option value="labor">üë∑ ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á (Labor)</option>
                            <option value="other">üìã ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Other)</option>
                        </select>
                    </div>
                    <div class="mb-4" id="expense-subcategory-container" style="display: none;">
                        <label class="block text-sm font-medium mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏¢‡πà‡∏≠‡∏¢</label>
                        <select id="expense-subcategory" class="input">
                            <option value="">-</option>
                            <option value="electric">‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</option>
                            <option value="water">‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                        <input type="text" id="expense-description" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°" required />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
                        <input type="number" step="0.01" id="expense-amount" class="input" min="0" required />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                        <input type="date" id="expense-date" class="input" required />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏ä‡∏≥‡∏£‡∏∞‡∏î‡πâ‡∏ß‡∏¢</label>
                        <select id="expense-payment" class="input">
                            <option value="cash">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</option>
                            <option value="transfer">‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</option>
                            <option value="credit_card">‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                        <input type="text" id="expense-notes" class="input" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°" />
                    </div>
                    <div class="flex gap-2">
                        <button type="submit" class="btn brand flex-1">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                        <button type="button" onclick="closeExpensesModal()" class="btn ghost flex-1">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Menu Listing Page -->
        <div id="menus-page" class="container hidden" style="padding-top: 16px; padding-bottom: 80px;">
            <header class="mb-6">
                <div class="flex items-center justify-between mb-2">
                    <h1 class="text-3xl font-bold">üçΩÔ∏è ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π</h1>
                    <div class="flex gap-2">
                        <button onclick="goToHomepage()" class="btn brand">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                        <button onclick="closeMenusPage()" class="btn ghost">
                            ‚Üê ‡∏Å‡∏•‡∏±‡∏ö
                        </button>
                    </div>
                </div>
                <p class="text-gray-600">‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡πÑ‡∏î‡πâ</p>
            </header>

            <!-- Filters -->
            <div class="card mb-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏ô‡∏π</label>
                        <input 
                            type="text" 
                            id="menu-search" 
                            class="input" 
                            placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠, ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏°‡∏ô‡∏π..."
                            onkeyup="debounceMenuSearch()"
                        />
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="menu-filter-status" class="input" onchange="loadMenus()">
                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                            <option value="active">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                            <option value="inactive">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button onclick="loadMenus()" class="btn brand w-full">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                    </div>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                <div class="card">
                    <div class="text-sm text-gray-600">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                    <div class="text-2xl font-bold" id="menu-total-count">0</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600">‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥</div>
                    <div class="text-2xl font-bold text-green-600" id="menu-available-count">0</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600">‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏≤‡∏î‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                    <div class="text-2xl font-bold text-red-600" id="menu-out-of-stock-count">0</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600">‡∏Å‡∏≥‡πÑ‡∏£‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                    <div class="text-2xl font-bold text-blue-600" id="menu-avg-profit">‡∏ø0.00</div>
                </div>
            </div>

            <!-- Menus Table -->
            <div class="card">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b">
                                <th class="text-left p-2 text-sm font-semibold">‡∏£‡∏´‡∏±‡∏™</th>
                                <th class="text-left p-2 text-sm font-semibold">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π</th>
                                <th class="text-right p-2 text-sm font-semibold">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢</th>
                                <th class="text-right p-2 text-sm font-semibold">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</th>
                                <th class="text-right p-2 text-sm font-semibold">‡∏Å‡∏≥‡πÑ‡∏£</th>
                                <th class="text-right p-2 text-sm font-semibold">% ‡∏Å‡∏≥‡πÑ‡∏£</th>
                                <th class="text-center p-2 text-sm font-semibold">‡∏ó‡∏≥‡πÑ‡∏î‡πâ (‡∏à‡∏≤‡∏ô)</th>
                                <th class="text-center p-2 text-sm font-semibold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="text-center p-2 text-sm font-semibold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="menus-table">
                            <tr>
                                <td colspan="9" class="text-center p-8">
                                    <div class="spinner" style="margin: 20px auto"></div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Menu Edit Modal -->
        <div id="menu-edit-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50" onclick="if(event.target === this) closeMenuEditModal()">
            <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏°‡∏ô‡∏π</h2>
                        <button onclick="closeMenuEditModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>

                    <!-- Menu Basic Info -->
                    <div class="card mb-4">
                        <h3 class="font-semibold mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π</label>
                                <input type="text" id="edit-menu-name" class="input" readonly />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ (‡∏ø)</label>
                                <input type="number" id="edit-menu-price" class="input" step="0.01" min="0" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô (‡∏ø) - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</label>
                                <input type="number" id="edit-menu-cost" class="input" step="0.01" min="0" readonly />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏Å‡∏≥‡πÑ‡∏£ (‡∏ø)</label>
                                <input type="number" id="edit-menu-profit" class="input" step="0.01" readonly />
                            </div>
                        </div>
                        <div class="mt-4">
                            <button onclick="recalculateMenuCost()" class="btn brand text-sm">üîÑ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
                        </div>
                    </div>

                    <!-- Ingredients/Recipe Section -->
                    <div class="card mb-4">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-semibold">üìã ‡∏™‡∏π‡∏ï‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö)</h3>
                            <button onclick="addIngredientToRecipe()" class="btn brand text-sm">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b bg-gray-50">
                                        <th class="text-left p-2">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</th>
                                        <th class="text-right p-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                                        <th class="text-left p-2">‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                        <th class="text-right p-2">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                        <th class="text-right p-2">‡∏£‡∏ß‡∏° (‡∏ø)</th>
                                        <th class="text-center p-2">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="menu-recipe-ingredients">
                                    <tr>
                                        <td colspan="6" class="text-center p-4 text-gray-500">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex gap-2 justify-end">
                        <button onclick="closeMenuEditModal()" class="btn ghost">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button onclick="saveMenuEdit()" class="btn brand">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Ingredient to Recipe Modal -->
        <div id="add-ingredient-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50" onclick="if(event.target === this) closeAddIngredientModal()">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4" onclick="event.stopPropagation()">
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-4">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</label>
                            <select id="add-ingredient-select" class="input">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö --</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                            <input type="number" id="add-ingredient-quantity" class="input" step="0.001" min="0" placeholder="0.000" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏´‡∏ô‡πà‡∏ß‡∏¢</label>
                            <input type="text" id="add-ingredient-unit" class="input" placeholder="‡∏Å‡∏£‡∏±‡∏°, ‡∏ï‡∏±‡∏ß, ‡∏ä‡πâ‡∏≠‡∏ô..." />
                        </div>
                    </div>
                    <div class="flex gap-2 justify-end mt-6">
                        <button onclick="closeAddIngredientModal()" class="btn ghost">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button onclick="confirmAddIngredient()" class="btn brand">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stock Reconciliation Page -->
        <div id="stock-reconciliation-page" class="container hidden" style="display: none; padding-top: 16px; padding-bottom: 80px;">
            <header class="mb-6">
                <div class="flex items-center justify-between mb-2">
                    <h1 class="text-3xl font-bold">üìã ‡∏ô‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å & ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</h1>
                    <div class="flex gap-2">
                        <button onclick="goToHomepage()" class="btn brand">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                        <button onclick="closeStockReconciliationPage()" class="btn ghost">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
                    </div>
                </div>
                <p class="text-gray-600">‡∏ô‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
            </header>

            <!-- Summary Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                <div class="card">
                    <div class="text-sm text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏±‡∏ö</div>
                    <div class="text-2xl font-bold" id="recon-total-count">0</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600">‡∏ô‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß</div>
                    <div class="text-2xl font-bold text-green-600" id="recon-counted">0</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600">‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á</div>
                    <div class="text-2xl font-bold text-red-600" id="recon-variances">0</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á</div>
                    <div class="text-2xl font-bold text-orange-600" id="recon-variance-value">‡∏ø0</div>
                </div>
            </div>

            <!-- Filters -->
            <div class="card mb-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</label>
                        <input type="text" id="recon-search" class="input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö..." />
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="recon-filter-status" class="input">
                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                            <option value="pending">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö</option>
                            <option value="counted">‡∏ô‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß</option>
                            <option value="variance">‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button onclick="loadStockReconciliation()" class="btn brand w-full">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å</button>
                    </div>
                    <div class="flex items-end">
                        <button onclick="saveStockReconciliation()" class="btn brand w-full">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö</button>
                    </div>
                </div>
            </div>

            <!-- Stock Count Table -->
            <div class="card">
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b bg-gray-50">
                                <th class="text-left p-2">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</th>
                                <th class="text-right p-2">‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</th>
                                <th class="text-right p-2">‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á</th>
                                <th class="text-right p-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á</th>
                                <th class="text-right p-2">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ (‡∏ø)</th>
                                <th class="text-center p-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            </tr>
                        </thead>
                        <tbody id="recon-table-body">
                            <tr>
                                <td colspan="6" class="text-center p-8 text-gray-500">
                                    ‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Packaging Management Page -->
        <div id="packaging-page" class="container hidden" style="display: none; padding-top: 16px; padding-bottom: 80px;">
            <header class="mb-6">
                <div class="flex items-center justify-between mb-2">
                    <h1 class="text-3xl font-bold">üì¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</h1>
                    <div class="flex gap-2">
                        <button onclick="goToHomepage()" class="btn brand">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                        <button onclick="closePackagingPage()" class="btn ghost">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
                    </div>
                </div>
                <p class="text-gray-600">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå ‡∏Å‡∏•‡πà‡∏≠‡∏á ‡∏ñ‡∏∏‡∏á ‡∏†‡∏≤‡∏ä‡∏ô‡∏∞ ‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</p>
            </header>

            <!-- Summary Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                <div class="card">
                    <div class="text-sm text-gray-600">‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                    <div class="text-2xl font-bold" id="packaging-total">0</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°</div>
                    <div class="text-2xl font-bold text-blue-600" id="packaging-value">‡∏ø0</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600">‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î</div>
                    <div class="text-2xl font-bold text-yellow-600" id="packaging-low">0</div>
                </div>
                <div class="card">
                    <div class="text-sm text-gray-600">‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß</div>
                    <div class="text-2xl font-bold text-red-600" id="packaging-out">0</div>
                </div>
            </div>

            <!-- Actions -->
            <div class="card mb-4">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                    <div class="flex gap-2">
                        <input type="text" id="packaging-search" class="input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå..." style="min-width: 200px;" />
                        <button onclick="loadPackaging()" class="btn ghost">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                    </div>
                    <button onclick="openPackagingModal()" class="btn brand">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</button>
                </div>
            </div>

            <!-- Packaging Table -->
            <div class="card">
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b bg-gray-50">
                                <th class="text-left p-2">‡∏ä‡∏∑‡πà‡∏≠</th>
                                <th class="text-left p-2">‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                <th class="text-right p-2">‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</th>
                                <th class="text-right p-2">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</th>
                                <th class="text-right p-2">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                                <th class="text-right p-2">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏£‡∏ß‡∏°</th>
                                <th class="text-center p-2">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="packaging-table-body">
                            <tr>
                                <td colspan="7" class="text-center p-8">
                                    <div class="spinner" style="margin: 20px auto"></div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- COGS Dashboard Page -->
        <div id="cogs-dashboard-page" class="container hidden" style="display: none; padding-top: 16px; padding-bottom: 80px;">
            <header class="mb-6">
                <div class="flex items-center justify-between mb-2">
                    <h1 class="text-3xl font-bold">üí∞ ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≤‡∏¢ (COGS) & ‡∏Å‡∏≥‡πÑ‡∏£</h1>
                    <div class="flex gap-2">
                        <button onclick="goToHomepage()" class="btn brand">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                        <button onclick="closeCOGSDashboard()" class="btn ghost">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
                    </div>
                </div>
                <p class="text-gray-600">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≤‡∏¢ ‡∏Å‡∏≥‡πÑ‡∏£ ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏ô‡∏π</p>
            </header>

            <!-- Period Selector -->
            <div class="card mb-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                        <input type="date" id="cogs-start-date" class="input" />
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
                        <input type="date" id="cogs-end-date" class="input" />
                    </div>
                    <div class="flex items-end">
                        <button onclick="loadCOGSDashboard()" class="btn brand w-full">üìä ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
                    </div>
                    <div class="flex items-end">
                        <button onclick="exportCOGSReport()" class="btn ghost w-full">üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</button>
                    </div>
                </div>
            </div>

            <!-- Summary Cards -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                <div class="card bg-blue-50">
                    <div class="text-sm text-gray-600 mb-1">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</div>
                    <div class="text-2xl font-bold text-blue-600" id="cogs-total-sales">‡∏ø0</div>
                </div>
                <div class="card bg-red-50">
                    <div class="text-sm text-gray-600 mb-1">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°</div>
                    <div class="text-2xl font-bold text-red-600" id="cogs-total-cost">‡∏ø0</div>
                </div>
                <div class="card bg-green-50">
                    <div class="text-sm text-gray-600 mb-1">‡∏Å‡∏≥‡πÑ‡∏£‡∏£‡∏ß‡∏°</div>
                    <div class="text-2xl font-bold text-green-600" id="cogs-total-profit">‡∏ø0</div>
                </div>
                <div class="card bg-purple-50">
                    <div class="text-sm text-gray-600 mb-1">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£</div>
                    <div class="text-2xl font-bold text-purple-600" id="cogs-profit-margin">0%</div>
                </div>
            </div>

            <!-- COGS Breakdown -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div class="card">
                    <h3 class="font-semibold mb-4">üìä ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</h3>
                    <div id="cogs-breakdown" class="space-y-2">
                        <div class="text-center text-gray-500 p-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="font-semibold mb-4">üçΩÔ∏è ‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</h3>
                    <div id="cogs-top-menus" class="space-y-2">
                        <div class="text-center text-gray-500 p-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                    </div>
                </div>
            </div>

            <!-- COGS Table -->
            <div class="card">
                <h3 class="font-semibold mb-4">üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î COGS</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b bg-gray-50">
                                <th class="text-left p-2">‡πÄ‡∏°‡∏ô‡∏π</th>
                                <th class="text-right p-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏≤‡∏¢</th>
                                <th class="text-right p-2">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</th>
                                <th class="text-right p-2">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</th>
                                <th class="text-right p-2">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</th>
                                <th class="text-right p-2">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°</th>
                                <th class="text-right p-2">‡∏Å‡∏≥‡πÑ‡∏£</th>
                                <th class="text-right p-2">% ‡∏Å‡∏≥‡πÑ‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="cogs-table-body">
                            <tr>
                                <td colspan="8" class="text-center p-8">
                                    <div class="spinner" style="margin: 20px auto"></div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Advanced Reports Dashboard -->
        <div id="reports-dashboard-page" class="container hidden" style="display: none; padding-top: 16px; padding-bottom: 80px;">
            <header class="mb-6">
                <div class="flex items-center justify-between mb-2">
                    <h1 class="text-3xl font-bold">üìà ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô & ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h1>
                    <div class="flex gap-2">
                        <button onclick="goToHomepage()" class="btn brand">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                        <button onclick="closeReportsDashboard()" class="btn ghost">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
                    </div>
                </div>
                <p class="text-gray-600">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</p>
            </header>

            <!-- Report Tabs -->
            <div class="card mb-4">
                <div class="flex flex-wrap gap-2 border-b">
                    <button onclick="showReportTab('sales')" class="px-4 py-2 border-b-2 border-blue-500 font-semibold" id="tab-sales">üìä ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</button>
                    <button onclick="showReportTab('costs')" class="px-4 py-2 text-gray-600 hover:text-gray-900" id="tab-costs">üí∞ ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</button>
                    <button onclick="showReportTab('inventory')" class="px-4 py-2 text-gray-600 hover:text-gray-900" id="tab-inventory">üì¶ ‡∏™‡∏ï‡πä‡∏≠‡∏Å</button>
                    <button onclick="showReportTab('kpi')" class="px-4 py-2 text-gray-600 hover:text-gray-900" id="tab-kpi">üéØ KPI</button>
                </div>
            </div>

            <!-- Period Selector -->
            <div class="card mb-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                        <input type="date" id="reports-start-date" class="input" />
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
                        <input type="date" id="reports-end-date" class="input" />
                    </div>
                    <div class="flex items-end">
                        <button onclick="loadReports()" class="btn brand w-full">üìä ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                    </div>
                    <div class="flex items-end">
                        <button onclick="exportReport()" class="btn ghost w-full">üì• ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</button>
                    </div>
                </div>
            </div>

            <!-- Sales Report Tab -->
            <div id="report-sales" class="report-tab">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div class="card">
                        <div class="text-sm text-gray-600 mb-1">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°</div>
                        <div class="text-2xl font-bold text-blue-600" id="report-sales-total">‡∏ø0</div>
                    </div>
                    <div class="card">
                        <div class="text-sm text-gray-600 mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
                        <div class="text-2xl font-bold text-green-600" id="report-orders-count">0</div>
                    </div>
                    <div class="card">
                        <div class="text-sm text-gray-600 mb-1">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                        <div class="text-2xl font-bold text-purple-600" id="report-avg-order">‡∏ø0</div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div class="card">
                        <h3 class="font-semibold mb-4">üìä ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á</h3>
                        <div id="report-sales-by-platform" class="space-y-2">
                            <div class="text-center text-gray-500 p-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="font-semibold mb-4">üçΩÔ∏è ‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ</h3>
                        <div id="report-top-menus" class="space-y-2">
                            <div class="text-center text-gray-500 p-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="font-semibold mb-4">üìà ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3>
                    <div id="report-daily-sales" class="space-y-2">
                        <div class="text-center text-gray-500 p-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                    </div>
                </div>
            </div>

            <!-- Costs Report Tab -->
            <div id="report-costs" class="report-tab hidden">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div class="card">
                        <div class="text-sm text-gray-600 mb-1">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</div>
                        <div class="text-2xl font-bold text-red-600" id="report-ingredient-cost">‡∏ø0</div>
                    </div>
                    <div class="card">
                        <div class="text-sm text-gray-600 mb-1">‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</div>
                        <div class="text-2xl font-bold text-orange-600" id="report-expenses">‡∏ø0</div>
                    </div>
                    <div class="card">
                        <div class="text-sm text-gray-600 mb-1">‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á</div>
                        <div class="text-2xl font-bold text-blue-600" id="report-labor">‡∏ø0</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="font-semibold mb-4">üí∞ ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</h3>
                    <div id="report-cost-breakdown" class="space-y-2">
                        <div class="text-center text-gray-500 p-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                    </div>
                </div>
            </div>

            <!-- Inventory Report Tab -->
            <div id="report-inventory" class="report-tab hidden">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div class="card">
                        <div class="text-sm text-gray-600 mb-1">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                        <div class="text-2xl font-bold text-blue-600" id="report-inventory-value">‡∏ø0</div>
                    </div>
                    <div class="card">
                        <div class="text-sm text-gray-600 mb-1">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô</div>
                        <div class="text-2xl font-bold text-green-600" id="report-turnover">0x</div>
                    </div>
                    <div class="card">
                        <div class="text-sm text-gray-600 mb-1">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î</div>
                        <div class="text-2xl font-bold text-red-600" id="report-low-stock-count">0</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="font-semibold mb-4">üì¶ ‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h3>
                    <div id="report-inventory-by-category" class="space-y-2">
                        <div class="text-center text-gray-500 p-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                    </div>
                </div>
            </div>

            <!-- KPI Report Tab -->
            <div id="report-kpi" class="report-tab hidden">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                    <div class="card bg-gradient-to-br from-blue-50 to-blue-100">
                        <div class="text-sm text-gray-600 mb-1">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£‡∏£‡∏ß‡∏°</div>
                        <div class="text-2xl font-bold text-blue-600" id="kpi-profit-margin">0%</div>
                    </div>
                    <div class="card bg-gradient-to-br from-green-50 to-green-100">
                        <div class="text-sm text-gray-600 mb-1">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Å</div>
                        <div class="text-2xl font-bold text-green-600" id="kpi-inventory-turnover">0x</div>
                    </div>
                    <div class="card bg-gradient-to-br from-purple-50 to-purple-100">
                        <div class="text-sm text-gray-600 mb-1">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                        <div class="text-2xl font-bold text-purple-600" id="kpi-avg-order-value">‡∏ø0</div>
                    </div>
                    <div class="card bg-gradient-to-br from-orange-50 to-orange-100">
                        <div class="text-sm text-gray-600 mb-1">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢/‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</div>
                        <div class="text-2xl font-bold text-orange-600" id="kpi-expense-ratio">0%</div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="card">
                        <h3 class="font-semibold mb-4">üìä KPI ‡∏™‡∏£‡∏∏‡∏õ</h3>
                        <div id="kpi-summary" class="space-y-3">
                            <div class="text-center text-gray-500 p-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="font-semibold mb-4">üìà ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</h3>
                        <div id="kpi-trends" class="space-y-3">
                            <div class="text-center text-gray-500 p-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Packaging Modal -->
        <div id="packaging-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50" onclick="if(event.target === this) closePackagingModal()">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4" onclick="event.stopPropagation()">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold" id="packaging-modal-title">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</h3>
                        <button onclick="closePackagingModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    <form id="packaging-form">
                        <input type="hidden" id="packaging-id" />
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
                            <input type="text" id="packaging-name" class="input" required />
                        </div>
                        <div class="mb-4 grid grid-cols-2 gap-2">
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏´‡∏ô‡πà‡∏ß‡∏¢</label>
                                <input type="text" id="packaging-unit" class="input" placeholder="‡∏ä‡∏¥‡πâ‡∏ô, ‡∏Å‡∏•‡πà‡∏≠‡∏á, ‡∏ñ‡∏∏‡∏á" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
                                <input type="number" step="0.01" id="packaging-stock" class="input" />
                            </div>
                        </div>
                        <div class="mb-4 grid grid-cols-2 gap-2">
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</label>
                                <input type="number" step="0.01" id="packaging-min" class="input" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ø)</label>
                                <input type="number" step="0.01" id="packaging-cost" class="input" />
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-2">‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢</label>
                            <input type="text" id="packaging-supplier" class="input" />
                        </div>
                        <div class="flex gap-2">
                            <button type="submit" class="btn brand flex-1">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                            <button type="button" onclick="closePackagingModal()" class="btn ghost flex-1">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Expense History Page -->
        <div id="expenses-history-page" class="container hidden" style="display: none; padding-top: 16px; padding-bottom: 80px;">
            <header class="mb-6">
                <div class="flex items-center justify-between mb-2">
                    <h1 class="text-3xl font-bold">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h1>
                    <button onclick="closeExpensesHistory()" class="btn ghost">
                        ‚Üê ‡∏Å‡∏•‡∏±‡∏ö
                    </button>
                </div>
                <p class="text-gray-600">‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
            </header>

            <!-- Filters -->
            <div class="card mb-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</label>
                        <input 
                            type="text" 
                            id="expense-search" 
                            class="input" 
                            placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î, ‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢, ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏..."
                            onkeyup="debounceExpenseSearch()"
                        />
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                        <select id="expense-filter-category" class="input" onchange="loadExpensesHistory()">
                            <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                            <option value="utility">‚ö° ‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ</option>
                            <option value="rental">üè† ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤</option>
                            <option value="labor">üë∑ ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á</option>
                            <option value="other">üìã ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà</label>
                        <input type="date" id="expense-filter-start" class="input" onchange="loadExpensesHistory()" />
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏ñ‡∏∂‡∏á</label>
                        <input type="date" id="expense-filter-end" class="input" onchange="loadExpensesHistory()" />
                    </div>
                </div>
                <div class="mt-4 flex gap-2">
                    <button onclick="loadExpensesHistory()" class="btn brand">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                    <button onclick="resetExpenseFilters()" class="btn ghost">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
                    <button onclick="openExpensesModal()" class="btn brand">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</button>
                </div>
            </div>

            <!-- Summary -->
            <div class="card mb-4">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div>
                        <div class="text-sm text-gray-600">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
                        <div class="text-2xl font-bold" id="expense-total-count">0</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</div>
                        <div class="text-2xl font-bold text-green-600" id="expense-total-amount">‡∏ø0.00</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ</div>
                        <div class="text-2xl font-bold" id="expense-page-count">0</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">‡∏´‡∏ô‡πâ‡∏≤</div>
                        <div class="text-2xl font-bold" id="expense-current-page">1</div>
                    </div>
                </div>
            </div>

            <!-- Expenses Table -->
            <div class="card">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b">
                                <th class="text-left p-2 text-sm font-semibold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th class="text-left p-2 text-sm font-semibold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                <th class="text-left p-2 text-sm font-semibold">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
                                <th class="text-right p-2 text-sm font-semibold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                                <th class="text-left p-2 text-sm font-semibold">‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢</th>
                                <th class="text-left p-2 text-sm font-semibold">‡∏ä‡∏≥‡∏£‡∏∞‡∏î‡πâ‡∏ß‡∏¢</th>
                                <th class="text-left p-2 text-sm font-semibold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏î‡∏¢</th>
                                <th class="text-left p-2 text-sm font-semibold">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</th>
                                <th class="text-left p-2 text-sm font-semibold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            </tr>
                        </thead>
                        <tbody id="expenses-history-table">
                            <tr>
                                <td colspan="9" class="text-center p-8">
                                    <div class="spinner" style="margin: 20px auto"></div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div id="expenses-pagination" class="flex items-center justify-between mt-4">
                    <div class="text-sm text-gray-600" id="expenses-page-info"></div>
                    <div class="flex gap-2">
                        <button id="expenses-prev" onclick="expensesPrevPage()" class="btn ghost text-sm">‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
                        <button id="expenses-next" onclick="expensesNextPage()" class="btn ghost text-sm">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Labor Cost Modal -->
        <div id="labor-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="card max-w-md w-full mx-4">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">üë∑ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á</h3>
                    <button onclick="closeLaborModal()" class="btn ghost text-sm">‚úï</button>
                </div>
                <form id="labor-form">
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
                        <input type="text" id="labor-employee" class="input" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" required />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                        <input type="date" id="labor-date" class="input" required />
                    </div>
                    <div class="mb-4 grid grid-cols-2 gap-2">
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
                            <input type="number" step="0.25" id="labor-hours" class="input" min="0" required />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á/‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</label>
                            <input type="number" step="0.01" id="labor-rate" class="input" min="0" required />
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á/‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</label>
                        <input type="text" id="labor-role" class="input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ä‡∏ü, ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü" />
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                        <input type="text" id="labor-notes" class="input" />
                    </div>
                    <div class="mb-4 p-2 bg-blue-50 rounded">
                        <div class="text-sm text-gray-600">üí∞ ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏£‡∏ß‡∏°: <span id="labor-total" class="font-bold text-blue-600">‡∏ø0.00</span></div>
                    </div>
                    <div class="flex gap-2">
                        <button type="submit" class="btn brand flex-1">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                        <button type="button" onclick="closeLaborModal()" class="btn ghost flex-1">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Google APIs for Sheets Integration -->
        <script async defer src="https://apis.google.com/js/api.js"></script>
        <script
            async
            defer
            src="https://apis.google.com/js/platform.js"
        ></script>

        <!-- Configuration -->
        <script src="config/integrations.js"></script>

        <!-- Logger (Load First) -->
        <script src="logger.js"></script>

        <!-- Scripts -->
        <script src="supabase-config.js"></script>
        <script src="pos-app.js"></script>
        
        <!-- Service Worker Registration for PWA -->
        <script>
            // Register Service Worker for offline support and PWA features
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    // Use relative path to work in all deployment scenarios
                    const swPath = './sw.js';
                    navigator.serviceWorker.register(swPath)
                        .then((registration) => {
                            console.log('‚úÖ Service Worker registered:', registration.scope);
                            
                            // Check for updates every hour
                            setInterval(() => {
                                registration.update();
                            }, 3600000);
                        })
                        .catch((error) => {
                            console.log('‚ö†Ô∏è Service Worker registration failed:', error);
                            // Not critical - app works without SW
                        });
                });
            }
        </script>

        <!-- Backfill Expenses Script -->
        <script src="backfill-expenses.js"></script>
        
        <!-- Load API Keys from Cloudflare Pages Environment -->
        <script>
            // Load API keys from Cloudflare Function
            // Note: Cloudflare Pages Functions route without .js extension
            // functions/api-keys.js is accessible at /api-keys (not /api-keys.js)
            (async function() {
                try {
                    const response = await fetch('/api-keys', {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/javascript, text/javascript, */*'
                        }
                    });
                    
                    if (response.ok) {
                        const contentType = response.headers.get('content-type') || '';
                        if (contentType.includes('javascript') || contentType.includes('text')) {
                            const jsCode = await response.text();
                            // Execute the JavaScript code
                            eval(jsCode);
                            console.log('‚úÖ API keys loaded successfully');
                        } else {
                            console.warn('‚ö†Ô∏è Unexpected content type:', contentType);
                        }
                    } else {
                        const errorText = await response.text().catch(() => '');
                        console.warn('‚ö†Ô∏è Could not load API keys from /api-keys:', response.status, response.statusText);
                        console.warn('‚ö†Ô∏è Response:', errorText.substring(0, 200));
                        console.warn('‚ö†Ô∏è Make sure GOOGLE_CLOUD_API_KEY and HUGGING_FACE_API_KEY are set in Cloudflare Pages environment variables');
                        console.warn('‚ö†Ô∏è Check Cloudflare Dashboard ‚Üí Workers & Pages ‚Üí pos-admin-bho ‚Üí Settings ‚Üí Environment Variables');
                        console.warn('‚ö†Ô∏è Also check Functions tab to ensure functions/api-keys.js is deployed');
                    }
                } catch (error) {
                    console.warn('‚ö†Ô∏è Error loading API keys:', error);
                    console.warn('‚ö†Ô∏è AI will fall back to pattern matching if API keys are not available');
                }
            })();
        </script>
        
        <!-- Intelligent Database-Aware AI Assistant -->
        <script src="ai-database-assistant.js"></script>
    </body>
</html>

